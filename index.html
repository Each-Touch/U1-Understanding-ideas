<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>åˆä¸­è‹±è¯­ç‚¹è¯»æœ¬ - The Secrets of Happiness</title>
    <style>
        :root { --main-brown: #8b4513; --bg-color: #fdf6e3; --text-color: #333; --highlight: #fff9db; }
        body { font-family: 'PingFang SC', 'Helvetica Neue', sans-serif; background: var(--bg-color); padding: 20px; color: var(--text-color); }
        .container { max-width: 900px; margin: 0 auto; background: white; padding: 40px; border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); }
        
        /* æ§åˆ¶é¢æ¿ */
        .controls { position: sticky; top: 10px; background: white; padding: 15px; border-radius: 12px; text-align: center; z-index: 100; margin-bottom: 30px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); border: 1px solid #eee; display: flex; flex-wrap: wrap; justify-content: center; gap: 15px; align-items: center; }
        select, input { padding: 8px; border-radius: 6px; border: 1px solid #ccc; font-size: 14px; }
        button { background: var(--main-brown); color: white; border: none; padding: 10px 20px; border-radius: 20px; cursor: pointer; font-weight: bold; transition: all 0.2s; }
        button:hover { transform: scale(1.05); background: #5d2e0d; }

        /* å†…å®¹æ ·å¼ */
        h1 { text-align: center; color: var(--main-brown); font-size: 28px; margin-bottom: 40px; }
        .paragraph { margin-bottom: 50px; position: relative; }
        .para-num { position: absolute; left: -40px; top: 10px; font-size: 24px; color: #d2b48c; font-style: italic; font-weight: bold; }

        .sentence-wrap { display: block; margin-bottom: 25px; cursor: pointer; padding: 12px; border-radius: 10px; transition: 0.3s; }
        .sentence-wrap:hover { background: var(--highlight); box-shadow: 2px 2px 10px rgba(0,0,0,0.05); }
        
        /* å•è¯æ’åˆ— */
        .en-line { display: flex; flex-wrap: wrap; gap: 4px 8px; margin-bottom: 8px; }
        .word-group { display: flex; flex-direction: column; align-items: center; min-width: 20px; }
        .word-group:hover .en-word { color: var(--main-brown); text-decoration: underline; }
        .en-word { font-size: 1.25em; font-weight: 500; line-height: 1.2; }
        .word-zh { font-size: 0.75em; color: #888; line-height: 1.2; margin-top: 2px; }
        
        /* å¥å­ç¿»è¯‘ */
        .sentence-zh { display: block; font-size: 1em; color: #5a7d5a; font-family: 'KaiTi', 'æ¥·ä½“', serif; padding-left: 5px; border-left: 3px solid #e0e0e0; }

        @media (max-width: 600px) { .para-num { position: static; display: block; margin-bottom: 10px; } }
    </style>
</head>
<body>

<div class="controls">
    <div>ğŸ—£ï¸ <select id="voiceSelect"><option>æ­£åœ¨åŠ è½½è¯­éŸ³åŒ…...</option></select></div>
    <div>ğŸ¢ è¯­é€Ÿ: <input type="range" id="rate" min="0.5" max="1.2" step="0.1" value="0.9"></div>
    <button onclick="readFullText()">ğŸ“– æœ—è¯»å…¨æ–‡</button>
</div>

<div class="container">
    <h1>The Secrets of Happiness</h1>
    <div id="content"></div>
</div>

<script>
    const synth = window.speechSynthesis;
    const voiceSelect = document.getElementById('voiceSelect');
    const rateInput = document.getElementById('rate');
    let voices = [];

    // å®Œæ•´çš„æ–‡ç« æ•°æ®ä¸è¯å…¸
    const article = [
        {
            num: 1,
            sentences: [
                { en: "I put down Charlie and the Chocolate Factory.", zh: "æˆ‘æ”¾ä¸‹äº†ã€ŠæŸ¥ç†å’Œå·§å…‹åŠ›å·¥å‚ã€‹ã€‚", words: {"I":"æˆ‘","put":"æ”¾ä¸‹","down":"æ”¾ä¸‹","Charlie":"æŸ¥ç†","and":"å’Œ","the":"è¿™","Chocolate":"å·§å…‹åŠ›","Factory":"å·¥å‚"} },
                { en: "But I kept going over the exciting story in my mind.", zh: "ä½†æˆ‘è„‘æµ·é‡Œä»åœ¨åå¤å›å‘³é‚£ä¸ªä»¤äººå…´å¥‹çš„æ•…äº‹ã€‚", words: {"But":"ä½†","kept":"ä¿æŒ","going":"ç»§ç»­","over":"åå¤","exciting":"å…´å¥‹çš„","story":"æ•…äº‹","in":"åœ¨","my":"æˆ‘çš„","mind":"è„‘æµ·"} },
                { en: "The book was full of magic.", zh: "è¿™æœ¬ä¹¦å……æ»¡äº†é­”åŠ›ã€‚", words: {"The":"è¿™","book":"ä¹¦","was":"æ˜¯","full":"å……æ»¡","of":"çš„","magic":"é­”åŠ›"} },
                { en: "But Charlie's happy family was the most magical part of the story.", zh: "ä½†æŸ¥ç†å¹¸ç¦çš„å®¶åº­æ‰æ˜¯æ•…äº‹ä¸­æœ€ç¥å¥‡çš„éƒ¨åˆ†ã€‚", words: {"But":"ä½†","Charlie's":"æŸ¥ç†çš„","happy":"å¹¸ç¦çš„","family":"å®¶åº­","was":"æ˜¯","the":"æœ€","most":"æœ€","magical":"ç¥å¥‡çš„","part":"éƒ¨åˆ†","of":"çš„","story":"æ•…äº‹"} }
            ]
        },
        {
            num: 2,
            sentences: [
                { en: "Charlie's home was a small house at the side of a big town.", zh: "æŸ¥ç†çš„å®¶æ˜¯å°é•‡è¾¹ä¸Šçš„ä¸€ä¸ªå°æˆ¿å­ã€‚", words: {"home":"å®¶","was":"æ˜¯","small":"å°çš„","house":"æˆ¿å­","at":"åœ¨","side":"æ—è¾¹","big":"å¤§çš„","town":"åŸé•‡"} },
                { en: "His family was very poor.", zh: "ä»–çš„å®¶åº­éå¸¸è´«ç©·ã€‚", words: {"His":"ä»–çš„","family":"å®¶åº­","was":"æ˜¯","very":"éå¸¸","poor":"è´«ç©·"} },
                { en: "His four grandparents stayed in the only bed in the house.", zh: "ä»–çš„å››ä½ç¥–çˆ¶æ¯å¾…åœ¨å®¶é‡Œå”¯ä¸€çš„åºŠä¸Šã€‚", words: {"four":"å››ä¸ª","grandparents":"ç¥–çˆ¶æ¯","stayed":"å¾…åœ¨","in":"åœ¨","only":"å”¯ä¸€çš„","bed":"åºŠ"} },
                { en: "The family never had enough food.", zh: "è¿™ä¸ªå®¶åº­ä»æ¥æ²¡æœ‰è¶³å¤Ÿçš„é£Ÿç‰©ã€‚", words: {"family":"å®¶åº­","never":"ä»ä¸","had":"æœ‰","enough":"è¶³å¤Ÿçš„","food":"é£Ÿç‰©"} },
                { en: "They always ate watery cabbage soup for dinner.", zh: "ä»–ä»¬æ™šé¤æ€»æ˜¯å–ç¨€è–„çš„å·å¿ƒèœæ±¤ã€‚", words: {"They":"ä»–ä»¬","always":"æ€»æ˜¯","ate":"åƒ","watery":"ç¨€è–„çš„","cabbage":"å·å¿ƒèœ","soup":"æ±¤","for":"ä½œä¸º","dinner":"æ™šé¤"} },
                { en: "In winter, the freezing wind swept across the floor all night long.", zh: "å†¬å¤©ï¼Œåˆºéª¨çš„å¯’é£æ•´æ™šæ¨ªæ‰«åœ°æ¿ã€‚", words: {"In":"åœ¨","winter":"å†¬å¤©","freezing":"åˆºéª¨çš„","wind":"å¯’é£","swept":"æ¨ªæ‰«","across":"ç©¿è¿‡","floor":"åœ°æ¿","all":"æ•´ä¸ª","night":"æ™šä¸Š","long":"é•¿"} }
            ]
        },
        {
            num: 3,
            sentences: [
                { en: "To my surprise, the family were happy together.", zh: "ä»¤æˆ‘æƒŠè®¶çš„æ˜¯ï¼Œå…¨å®¶äººåœ¨ä¸€èµ·å¾ˆå¹¸ç¦ã€‚", words: {"To":"ä»¤","my":"æˆ‘çš„","surprise":"æƒŠè®¶","family":"å®¶äºº","were":"æ˜¯","happy":"å¹¸ç¦","together":"åœ¨ä¸€èµ·"} },
                { en: "In the evenings, Charlie sat with his grandparents in bed and listened to their stories.", zh: "åœ¨æ™šä¸Šï¼ŒæŸ¥ç†å’Œç¥–çˆ¶æ¯ååœ¨åºŠä¸Šå¬ä»–ä»¬è®²æ•…äº‹ã€‚", words: {"evenings":"æ™šä¸Š","sat":"å","with":"å’Œ","grandparents":"ç¥–çˆ¶æ¯","listened":"å¬","stories":"æ•…äº‹"} },
                { en: "Charlie's parents often joined in.", zh: "æŸ¥ç†çš„çˆ¶æ¯ä¹Ÿç»å¸¸åŠ å…¥è¿›æ¥ã€‚", words: {"parents":"çˆ¶æ¯","often":"ç»å¸¸","joined":"åŠ å…¥","in":"ä¸­"} },
                { en: "Every night, the room became a happy place.", zh: "æ¯å¤©æ™šä¸Šï¼Œæˆ¿é—´éƒ½å˜æˆäº†ä¸€ä¸ªå¿«ä¹çš„åœ°æ–¹ã€‚", words: {"Every":"æ¯","night":"æ™š","room":"æˆ¿é—´","became":"å˜æˆ","happy":"å¿«ä¹","place":"åœ°æ–¹"} },
                { en: "The whole family forgot about their hungry and poor life.", zh: "å…¨å®¶äººéƒ½å¿˜è®°äº†ä»–ä»¬é¥¥é¥¿è´«å›°çš„ç”Ÿæ´»ã€‚", words: {"whole":"æ•´ä¸ª","family":"å®¶äºº","forgot":"å¿˜è®°","about":"å…³äº","hungry":"é¥¥é¥¿","poor":"è´«ç©·","life":"ç”Ÿæ´»"} }
            ]
        },
        {
            num: 4,
            sentences: [
                { en: "This touched me greatly.", zh: "è¿™æå¤§åœ°è§¦åŠ¨äº†æˆ‘ã€‚", words: {"This":"è¿™","touched":"è§¦åŠ¨","me":"æˆ‘","greatly":"æå¤§åœ°"} },
                { en: "In some people's minds, happiness comes from things like money.", zh: "åœ¨ä¸€äº›äººçš„å¿ƒç›®ä¸­ï¼Œå¹¸ç¦æ¥è‡ªé‡‘é’±ä¹‹ç±»çš„äº‹ç‰©ã€‚", words: {"some":"ä¸€äº›","minds":"å¿ƒç›®","happiness":"å¹¸ç¦","comes":"æ¥è‡ª","from":"ä»","things":"äº‹ç‰©","like":"åƒ","money":"é‡‘é’±"} },
                { en: "But love, in fact, is the key to happiness.", zh: "ä½†çˆ±ï¼Œäº‹å®ä¸Šï¼Œæ˜¯å¹¸ç¦çš„å…³é”®ã€‚", words: {"But":"ä½†","love":"çˆ±","in":"åœ¨","fact":"äº‹å®","is":"æ˜¯","key":"å…³é”®","to":"å¯¹äº"} },
                { en: "Oscar Wilde once said, 'Keep love in your heart.'", zh: "å¥¥æ–¯å¡Â·ç‹å°”å¾·æ›¾è¯´è¿‡ï¼šâ€˜æŠŠçˆ±ç•™åœ¨å¿ƒé‡Œã€‚â€™", words: {"said":"è¯´","Keep":"ä¿æŒ","love":"çˆ±","your":"ä½ çš„","heart":"å¿ƒ"} },
                { en: "A life without it is like a sunless garden...", zh: "æ²¡æœ‰çˆ±çš„ç”Ÿæ´»å°±åƒä¸€åº§æ²¡æœ‰é˜³å…‰çš„èŠ±å›­â€¦â€¦", words: {"life":"ç”Ÿæ´»","without":"æ²¡æœ‰","it":"å®ƒ","like":"åƒ","sunless":"æ— é˜³å…‰","garden":"èŠ±å›­"} },
                { en: "I think love is the most important one.", zh: "æˆ‘è®¤ä¸ºçˆ±æ˜¯æœ€é‡è¦çš„ä¸€ä¸ªï¼ˆåŸå› ï¼‰ã€‚", words: {"think":"è®¤ä¸º","love":"çˆ±","most":"æœ€","important":"é‡è¦","one":"ä¸€ä¸ª"} },
                { en: "It can move us, change us and give us a life full of happiness.", zh: "å®ƒå¯ä»¥æ„ŸåŠ¨æˆ‘ä»¬ï¼Œæ”¹å˜æˆ‘ä»¬ï¼Œç»™æˆ‘ä»¬ä¸€ä¸ªå……æ»¡å¹¸ç¦çš„ç”Ÿæ´»ã€‚", words: {"move":"ç§»åŠ¨/æ„ŸåŠ¨","us":"æˆ‘ä»¬","change":"æ”¹å˜","give":"ç»™äºˆ","full":"å……æ»¡"} }
            ]
        }
    ];

    // åˆå§‹åŒ–è¯­éŸ³åˆ—è¡¨
    function loadVoices() {
        voices = synth.getVoices();
        voiceSelect.innerHTML = voices
            .filter(v => v.lang.includes('en'))
            .map(v => `<option value="${v.name}">${v.name} (${v.lang.includes('GB')?'è‹±éŸ³':'ç¾éŸ³'})</option>`)
            .join('');
    }

    // æ¸²æŸ“å†…å®¹
    function render() {
        const content = document.getElementById('content');
        article.forEach(p => {
            let pDiv = document.createElement('div');
            pDiv.className = 'paragraph';
            pDiv.innerHTML = `<span class="para-num">${p.num}</span>`;
            
            p.sentences.forEach(s => {
                let sDiv = document.createElement('div');
                sDiv.className = 'sentence-wrap';
                sDiv.onclick = () => speak(s.en);
                
                let wordsHtml = s.en.split(' ').map(rawWord => {
                    let clean = rawWord.replace(/[.,'â€™!?;]/g, '');
                    let zh = s.words[clean] || s.words[rawWord] || "";
                    return `<div class="word-group" onclick="event.stopPropagation(); speak('${clean}')">
                                <span class="en-word">${rawWord}</span>
                                <span class="word-zh">${zh}</span>
                            </div>`;
                }).join('');
                
                sDiv.innerHTML = `<div class="en-line">${wordsHtml}</div><div class="sentence-zh">${s.zh}</div>`;
                pDiv.appendChild(sDiv);
            });
            content.appendChild(pDiv);
        });
    }

    function speak(text) {
        synth.cancel();
        const utter = new SpeechSynthesisUtterance(text);
        const voice = voices.find(v => v.name === voiceSelect.value);
        if (voice) utter.voice = voice;
        utter.rate = rateInput.value;
        synth.speak(utter);
    }

    function readFullText() {
        let allEn = article.flatMap(p => p.sentences.map(s => s.en)).join(' ');
        speak(allEn);
    }

    window.onload = () => {
        render();
        loadVoices();
        if (speechSynthesis.onvoiceschanged !== undefined) {
            speechSynthesis.onvoiceschanged = loadVoices;
        }
    };
</script>
</body>
</html>